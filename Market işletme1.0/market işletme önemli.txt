using System;
using System.Data.OleDb; // Access veritabanı için OleDb kütüphanesini ekleyin
using System.Windows.Forms;

namespace VeriTabaniComboBoxListView
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            VeriTabanindanVeriCekComboBox();
            VeriTabanindanVeriCekListView();
        }

        private void VeriTabanindanVeriCekComboBox()
        {
            string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=VeritabaniAdi.accdb;Persist Security Info=False;";

            using (OleDbConnection connection = new OleDbConnection(connectionString))
            {
                connection.Open();

                string query = "SELECT Adi FROM TabloAdi";
                using (OleDbCommand command = new OleDbCommand(query, connection))
                {
                    using (OleDbDataReader reader = command.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            comboBox1.Items.Add(reader["Adi"].ToString());
                        }
                    }
                }
            }
        }

        private void VeriTabanindanVeriCekListView()
        {
            string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=VeritabaniAdi.accdb;Persist Security Info=False;";

            using (OleDbConnection connection = new OleDbConnection(connectionString))
            {
                connection.Open();

                string query = "SELECT Adi, Soyadi, Yas FROM TabloAdi";
                using (OleDbCommand command = new OleDbCommand(query, connection))
                {
                    using (OleDbDataReader reader = command.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            ListViewItem item = new ListViewItem(reader["Adi"].ToString());
                            item.SubItems.Add(reader["Soyadi"].ToString());
                            item.SubItems.Add(reader["Yas"].ToString());
                            listView1.Items.Add(item);
                        }
                    }
                }
            }
        }
    }
}
